# 批量檔案重命名工具 (Bulk File Renamer)

一個功能豐富的桌面應用程式，用於批量重命名檔案。支援多種重命名規則和預覽功能。

![版本](https://img.shields.io/badge/版本-1.0.0-blue.svg)
![Python](https://img.shields.io/badge/Python-3.7+-green.svg)
![授權](https://img.shields.io/badge/授權-MIT-red.svg)

## 功能特色

### 🎯 多種重命名規則
- **前綴/後綴添加** - 在檔名前後添加指定文字
- **文字替換** - 將檔名中的特定文字替換為新文字
- **序列編號** - 為檔案添加序列編號（如 001, 002, 003...）
- **大小寫轉換** - 支援全大寫、全小寫、首字母大寫等
- **組合規則** - 可同時應用多個規則，按順序執行

### 📋 預覽功能
- **即時預覽** - 在執行前查看重命名結果
- **衝突檢測** - 自動檢測檔名衝突和無效檔名
- **詳細資訊** - 顯示檔案大小、修改時間等資訊
- **批量選擇** - 支援全選、反選等批量操作

### 🔄 歷史管理
- **操作記錄** - 完整記錄每次重命名操作
- **一鍵復原** - 可復原上一次或指定的重命名操作
- **歷史匯出** - 將操作歷史匯出為 JSON 檔案

### 🎛️ 進階功能
- **檔案過濾** - 按副檔名或檔名模式過濾檔案
- **設定儲存** - 自動儲存使用者偏好設定
- **錯誤處理** - 完善的錯誤提示和異常處理
- **中文介面** - 完整的繁體中文使用者介面

## 系統需求

- **作業系統**: Windows 7/8/10/11
- **Python 版本**: 3.7 或更高版本
- **依賴套件**: tkinter（通常隨 Python 一起安裝）

## 安裝與執行

### 方法一：直接執行 Python 腳本

1. 確保您的系統已安裝 Python 3.7+
2. 下載或複製專案檔案
3. 在專案根目錄開啟命令提示字元
4. 執行以下命令：

```bash
python main.py
```

### 方法二：建立執行檔（可選）

如果您想建立獨立的執行檔，可以使用 PyInstaller：

```bash
# 安裝 PyInstaller
pip install pyinstaller

# 建立執行檔
pyinstaller --onefile --windowed --name "批量檔案重命名工具" main.py
```

## 使用說明

### 基本操作流程

1. **選擇目錄**
   - 點擊「瀏覽目錄」按鈕
   - 選擇包含要重命名檔案的資料夾

2. **設定過濾條件**（可選）
   - 在「檔案過濾」區域輸入副檔名
   - 例如：`.txt,.jpg,.png`

3. **配置重命名規則**
   - 選擇規則類型（前綴、後綴、替換等）
   - 填入相應的參數
   - 點擊「應用規則」

4. **預覽結果**
   - 點擊「預覽重命名」查看結果
   - 檢查是否有衝突或錯誤

5. **執行重命名**
   - 確認無誤後點擊「執行重命名」
   - 系統會提示確認對話框

6. **管理歷史**
   - 在「操作歷史」分頁查看過往操作
   - 如需要可點擊「復原操作」

### 重命名規則詳解

#### 前綴/後綴
- **前綴**: 在檔名前方添加文字
- **後綴**: 在檔名後方（副檔名前）添加文字
- 範例: `document.txt` → `新_document_備份.txt`

#### 文字替換
- **尋找**: 要被替換的文字
- **替換為**: 新的文字內容
- **包含副檔名**: 是否在副檔名中也進行替換
- 範例: `old_file.txt` → `new_file.txt`（將 old 替換為 new）

#### 序列編號
- **起始編號**: 編號的起始數字
- **位數**: 編號的總位數（不足補零）
- 範例: `file1.txt, file2.txt` → `001.txt, 002.txt`

#### 大小寫轉換
- **全部大寫**: `filename.txt` → `FILENAME.txt`
- **全部小寫**: `FILENAME.txt` → `filename.txt`
- **首字母大寫**: `filename.txt` → `Filename.txt`
- **標題格式**: `file name.txt` → `File Name.txt`

### 檔案過濾

支援多種過濾方式：

- **副檔名過濾**: `.txt,.jpg,.png`
- **檔名模式**: 支援正規表達式
- **組合過濾**: 可同時使用多個條件

## 專案結構

```
bulk-file-renamer/
├── main.py                 # 主程式入口
├── src/                    # 源碼目錄
│   ├── __init__.py
│   ├── file_renamer.py     # 核心重命名邏輯
│   └── gui/                # 圖形使用者介面
│       ├── __init__.py
│       ├── main_window.py  # 主視窗
│       ├── rule_panel.py   # 規則設定面板
│       ├── preview_panel.py # 預覽面板
│       └── history_panel.py # 歷史記錄面板
├── README.md               # 專案說明文件
├── requirements.txt        # 依賴套件清單
└── LICENSE                 # 授權檔案
```

## 注意事項

### 安全提醒
- **備份重要檔案**: 執行重命名前請備份重要資料
- **測試小範圍**: 建議先在少量檔案上測試規則
- **檢查預覽**: 務必仔細檢查預覽結果再執行

### 限制說明
- 不支援重命名系統檔案或受保護的檔案
- 檔名長度受作業系統限制（Windows 通常為 255 字元）
- 不支援跨磁碟機的檔案移動

### 疑難排解

**問題：無法啟動程式**
- 檢查 Python 版本是否為 3.7+
- 確認 tkinter 模組已正確安裝

**問題：重命名失敗**
- 檢查檔案是否被其他程式佔用
- 確認對目標目錄有寫入權限
- 檢查檔名是否包含無效字元

**問題：預覽結果不正確**
- 檢查規則設定是否正確
- 確認檔案過濾條件
- 重新整理檔案列表
